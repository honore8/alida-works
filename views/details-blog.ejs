<!doctype html>
<html lang="en">

<%- include('./partials/header.ejs') %>

    <body>

        <main>
            <div class="container">
                <%- include('./partials/nav.ejs') %>
                    <h1>
                        <%=blog.title%> <p class="float-end"><a data-doc="<%=blog._id  %> " class="btn btn-danger btn-md px-4">Delete</a></p> 
                    </h1>

                    <i>Post on: <%=blog.createdAt %> </i>
                    <p class="fs-5 col-12 mt-4">
                        <%-blog.body%>
                    </p>
                    <div class="mb-5">
                        <a data-doc="<%=blog._id  %> " class="btn btn-danger btn-md px-4">Delete</a>
                    </div>
            </div>

        </main>

        <%- include('./partials/footer.ejs') %>

            <script>
                const trashcan = document.querySelector('a.btn')
                trashcan.addEventListener('click', (e) => {
                    if (window.confirm('Are you sure you want to delete this blog ?')) {
                        const endpoint = `/blog/${trashcan.dataset.doc}`
                        fetch(endpoint, {
                            method: 'DELETE'
                        })
                            .then((response) => response.json())
                            .then((data) => window.location.href = data.redirect)
                            .catch((err) => {
                                console.log(err);
                            })
                    }
                })
            </script>
    </body>

</html>